// This is an autogenerated file from Firebase Studio.
'use server';

/**
 * @fileOverview Explains a specific vulnerability in more detail using AI.
 *
 * - explainVulnerability - A function that takes vulnerability details and returns an AI explanation.
 * - ExplainVulnerabilityInput - The input type for the explainVulnerability function.
 * - ExplainVulnerabilityOutput - The return type for the explainVulnerability function.
 */

import {ai} from '@/ai/genkit';
import {z} from 'genkit';

const ExplainVulnerabilityInputSchema = z.object({
  vulnerabilityDetails: z.string().describe('Detailed information about the vulnerability.'),
});

export type ExplainVulnerabilityInput = z.infer<typeof ExplainVulnerabilityInputSchema>;

const ExplainVulnerabilityOutputSchema = z.object({
  explanation: z.string().describe('A detailed explanation of the vulnerability and its potential impact, formatted in Markdown.'),
  remediation: z.string().describe('Suggested steps to remediate the vulnerability, formatted in Markdown.'),
});

export type ExplainVulnerabilityOutput = z.infer<typeof ExplainVulnerabilityOutputSchema>;

export async function explainVulnerability(input: ExplainVulnerabilityInput): Promise<ExplainVulnerabilityOutput> {
  return explainVulnerabilityFlow(input);
}

const prompt = ai.definePrompt({
  name: 'explainVulnerabilityPrompt',
  input: {schema: ExplainVulnerabilityInputSchema},
  output: {schema: ExplainVulnerabilityOutputSchema},
  prompt: `You are a security expert. Your task is to explain a vulnerability based on the details provided.

  **Vulnerability Details:**
  {{{vulnerabilityDetails}}}

  **Instructions:**
  1.  **Explanation:** Provide a detailed explanation of the vulnerability. Describe what it is, how it works, and what its potential impact could be.
  2.  **Remediation:** Suggest clear, actionable steps to fix the vulnerability. Include code examples where appropriate.
  
  **Formatting:**
  - Use **Markdown** for all formatting.
  - Use headings (e.g., \`## Explanation\`, \`## Remediation\`) to structure your response.
  - Use lists (bulleted or numbered) for steps and key points.
  - Use code blocks (\`\`\`language\`) for any code snippets.
  `,
});

const explainVulnerabilityFlow = ai.defineFlow(
  {
    name: 'explainVulnerabilityFlow',
    inputSchema: ExplainVulnerabilityInputSchema,
    outputSchema: ExplainVulnerabilityOutputSchema,
  },
  async input => {
    const {output} = await prompt(input);
    return output!;
  }
);
